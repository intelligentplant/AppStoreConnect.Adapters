# Release Notes - v6.0.0

Welcome to version 6.0.0 of the adapter toolkit for App Store Connect!


# :warning: Breaking Changes

This release contains a number of breaking changes:


## Removal of out-of-support target frameworks

Support for .NET 6 and .NET 7 has been removed, as these frameworks are no longer supported by Microsoft.


## New `FeatureBase` base type for delegated adapter features

A new `FeatureBase` type has been added as the base class for features that are implemented externally to an adapter. Inheriting from the new base class results in breaking changes on types derived from `SubscriptionManager<TOptions, TTopic, TValue, TSubscription>` as the `GetHealthCheckProperties` method has been removed and implementations must instead override `FeatureBase.GetFeatureHealthCheckData` instead.


## `IAdapterFeature` no longer inherits from `IBackgroundTaskServiceProvider`

In order to simplify the feature mode, `IAdapterFeature` no longer inherits from `IBackgroundTaskServiceProvider`. The following types have also have related breaking changes:

- `AdapterFeatureWrapper` no longer implements `IBackgroundTaskServiceProvider`.
- `AssetModelManager` no longer implements `IBackgroundTaskServiceProvider` and no longer accepts an `IBackgroundTaskService` constructor parameter.
- `HealthCheckManager` no longer implements `IBackgroundTaskServiceProvider`.
- `CustomFunctions` no longer implements `IBackgroundTaskServiceProvider` and no longer accepts an `IBackgroundTaskService` constructor parameter.
- `SubscriptionManager` no longer implements `IBackgroundTaskServiceProvider` but its constructor is unchanged. Its `BackgroundTaskService` property has changed from public to protected.
- `TagManager` no longer implements `IBackgroundTaskServiceProvider` and no longer accepts an `IBackgroundTaskService` constructor parameter.


## `CustomFunctions` denies authorization by default

The `CustomFunctions` class now denies authorization to all callers by default instead of allowing by default. Adapters are expected to add explicit authorization handlers for each custom function that they wish to expose, or modify the default authorization handler to allow or deny callers as appropriate on a case-by-case basis.


## `StringCache.Size` removed

The `StringCache.Size` property has been removed due to an under-the-hood dependency change. A new `CaclculateSize` method has been added that can be used to calculate the current size of the cache on demand.


# Non-Breaking Changes

This release includes the following non-breaking changes and features:


## Support for custom feature URIs

`AdapterDescriptorBuilder` will allow any URI to be registered as a feature URI as long as the URI is absolute.


## `AdapterBase<TAdapterOptions>` supports custom functions by default

The `AdapterBase<TAdapterOptions>` now enables custom functions by default via a protected `CustomFunctions` object. Implementing classes can register custom functions with this provider.


## Simplified creation of JSON `Variant` instances

The new `Variant.FromJsonValue<T>` static methods can be used to serialize a value to JSON and create a `Variant` instance from the serialized JSON in a single step. Previously, it was necessary to manually serialize to `JsonElement` first before creating the `Variant` instance.


## Refactored `dotnet new` template

The `dotnet new` template has been refactored to create 3 separate projects when used:

- An adapter project that contains the adapter implementation.
- An adapter host project that runs the adapter in an ASP.NET Core application.
- A unit test project that contains MSTest unit tests for the adapter.
